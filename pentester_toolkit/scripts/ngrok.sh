#!/bin/bash
# Author: Emma Heffernan
# Description: Runs a remote server to view files on the machine

# Initialising the variables
NGROK_AUTH=""
NGROK_DIR=""
NGROK_PORT="80"

# Creating titles and options list for user input, along with warning message
echo ""
echo "WARNING!! Please ensure you have specified -p 80:80 when you ran the container"
echo ""
echo "Sign up to NGROK at https://dashboard.ngrok.com/signup"
echo "NOTE: If no authtoken is entered, the session will expire in 2 hours"
# User is asked to enter this authtoken if they're registered, otherwise users can enter and only use for max of 2 hours
read -e -p "Please enter your NGROK authtoken: " NGROK_AUTH

# The command will run using ngok with the authtoken entered by user
ngrok authtoken $NGROK_AUTH

# The user will then be asked if they want to enter a directory or use the default
read -e -p "Please enter the directory to share (Default: /): " NGROK_DIR
NGROK_DIR=${NGROK_DIR:-/}
# The command which will run will use webdav wsgidav with host of 0.0.0.0 and port which is defaulted at 80 from above and the ngrok directory the user can enter or the default with anonymous authentication
wsgidav --host=0.0.0.0 --port=$NGROK_PORT --root=$NGROK_DIR --auth=anonymous &
sleep 10
# The command will run using the ngrok command with http and the port the user enters or the default of 80
ngrok http $NGROK_PORT