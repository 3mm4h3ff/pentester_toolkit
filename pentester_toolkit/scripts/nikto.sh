#!/bin/bash
# Author: Emma Heffernan
# Description: Scans a webpage or website for vulnerabilties using command line scanner Nikto

# Initialising the toolexit variable to equal 0
TOOL_EXIT=0
# Running until the user wants to exit the tool
while [ $TOOL_EXIT == 0 ]; do 

    # Initialising the variables
    NIKTO_PORT=""
    NIKTO_IP=""
    NIKTO_OPT=""
    NIKTO_PROXY=""
    PROXY_PORT=""

    # Creating titles and options list for user input
    echo ""
    echo "Nikto Helper"
    echo ""
    echo "Please select 1 of the following options: "
    echo ""
    echo " 1. Scan a Host"
    echo " 2. Scan Specific Ports of Host"
    echo " 3. Web Host Scan via a Proxy"
    echo " 0. Exit Nikto Basics"
    # Intaking the user input for above options
    read -e -p "Please enter an option: " USER_INPUT
    # Rely to the user what they entered
    echo "You entered: $USER_INPUT" 
    
    # Matching the options in the menu above, the user can input their option choice, first here being to exit the problem
    if [[ $USER_INPUT == 0 ]]; then
        TOOL_EXIT=1
    # Next the user can scan a webpage by entering the IP or domain and the ports of 80 and 443 will be scanned
    elif [[ $USER_INPUT == 1 ]]; then
        read -e -p "Enter IP or Hostname: " NIKTO_IP
        NIKTO_PORT="80,443"
    # Next the user can scan their own choice of ports by entering port numbers and IP on the website
    elif [[ $USER_INPUT == 2 ]]; then
        read -e -p "Enter IP or Hostname: " NIKTO_IP
        read -e -p "Enter Port(s): " NIKTO_PORT
    # Lastly the user can scan the webpage on the port and use a proxy
    elif [[ $USER_INPUT == 3 ]]; then
        read -e -p "Enter IP or Hostname: " NIKTO_IP
        read -e -p "Enter Port: " NIKTO_PORT
        read -e -p "Enter Proxy URL: " NIKTO_PROXY
        read -e -p "Enter Proxy Port: " PROXY_PORT
        NIKTO_OPT="-useproxy"
        # Starts a webdav server on localhost using the specified port with no user authenication and having the root set to /
        wsgidav --host=127.0.0.1 --port=$PROXY_PORT --auth=anonymous -r / &
        sleep 10
    else
        echo "Incorrect option, please try again!"
    fi
    # Runs Nikto with user specified inputs
    if [[ TOOL_EXIT != 0 ]]; then
        nikto.pl -h $NIKTO_IP -port $NIKTO_PORT $NIKTO_OPT $NIKTO_PROXY 
    fi
# End of the do while loop
done
